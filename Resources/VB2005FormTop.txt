
Option Strict Off
Imports ActiveLock3_5NET
Imports System.IO
Imports Microsoft.VisualBasic.FileSystem
Imports VB = Microsoft.VisualBasic.Strings
Imports Microsoft.VisualBasic.Compatibility

Module modActiveLockVb2005

    Public Structure ActivelockValues_t
        Public RegStatus As String
        Public UsedDaysOrRuns As String
        Public ValidTrial As Boolean
        Public LicenceType As String
        Public ExpirationDate As String
        Public RegisteredUser As String
        Public RegisteredLevel As String
        Public LicenseClass As String
        Public MaxCount As Integer
    End Structure

    Public ActivelockValues As New ActivelockValues_t
    Dim noTrialThisTime As Boolean
    Private MyActiveLock As ActiveLock3_5NET._IActiveLock
    Private WithEvents ActiveLockEventSink As ActiveLock3_5NET.ActiveLockEventNotifier
    'Windows and System directory API
    Private Declare Function GetSystemDirectory Lib "kernel32" Alias "GetSystemDirectoryA" (ByVal lpBuffer As String, ByVal nSize As Integer) As Integer
    Private Declare Function GetWindowsDirectory Lib "kernel32" Alias "GetWindowsDirectoryA" (ByVal lpBuffer As String, ByVal nSize As Integer) As Integer
    